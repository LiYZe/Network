# IP协议

规定网络地址的协议，为每一台计算机分配IP地址。

确定哪些地址在同一个子网络。

它所定义的地址，就被称为IP地址。

广泛采用的是IP协议第四版，简称IPv4。

## IP地址

地址分成两个部分，前一部分代表网络，后一部分代表主机。

### 动态IP地址

计算机开机后，会自动分配到一个IP地址，不用人为设定。

使用的协议为DHCP协议。

#### DHCP协议

应用层协议，建立在UDP协议之上

<div align = "center"><img src = "https://user-images.githubusercontent.com/37955886/119923263-f8d1b700-bfa3-11eb-8e20-9f381de40cb5.png"/></div>
  
### DNS协议

只知道网址，不知道IP地址的情况下，使用DNS协议可以将网址转换为IP地址。

## 子网掩码

用于区分地址中的网络和主机部分。

32位二进制数字，网络部分全部为1，主机部分全部为0

# IP数据包

IP协议发送的数据。

存放于以太网数据包的“数据”部分。

分为“标头”和“数据”两部分。

## 标头

主要包括版本、长度、IP地址等信息

## 数据

IP数据包的具体内容

# ARP协议

从IP地址中得到MAC地址。

1.两台主机在不同的子网，将数据包传送到连接两个子网的“网关”，交给网关；

2.在同一个子网中，使用ARP协议。

# RARP协议

将MAC地址解析成为对应的IP地址

## 原理

发送一个数据包，包含所要查询主机的IP地址，MAC地址为FF:FF:FF:FF:FF:FF，表示"广播"地址，每一个子网中的主机都睡收到该数据包，将包中的IP地址与自身对比，如果相同，则回复，否则丢弃。

# IP路由选择

1.搜索路由表，优先搜索匹配主机，如果能找到和IP地址完全一致的目标主机，则将该包发向目标主机

2.搜索路由表，如果匹配主机失败，则匹配同子网的路由器，这需要子网掩码的协助。如果找到路由器，则将该包发向路由器。

3.搜索路由表，如果匹配同子网路由器失败，则匹配同网号路由器，如果找到路由器，则将该包发向路由器。

4.搜索路由表，如果以上都失败了，就搜索默认路由，如果默认路由存在，则发包
如果都失败了，就丢掉这个包

# IP数据报

![image](https://user-images.githubusercontent.com/37955886/119926259-a0051d00-bfa9-11eb-89a9-582680962ea8.png)

# ICMP协议

传递差错报文以及其他信息

## 差错报文

当传送IP数据报发生错误时，ICMP协议将会发送一个ICMP差错报文给源主机，好让主机做出相应的处理。

### ping

ping程序时对两个TCP/IP系统连通性进行测试的基本工具。

利用ICMP回显请求和回显应答报文，而不用经过传输层。















